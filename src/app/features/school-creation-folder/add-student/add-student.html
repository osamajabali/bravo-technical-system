<div class="card">
    <div class="card-header bg-primary text-white">
        <h4>Add Teacher</h4>
    </div>
    <div class="card-body">
        <!-- Required Excel Format Section -->
        <div class="alert alert-info mb-3">
            <ol class="mb-0">
                <li class="mb-2">
                    <strong>Step 1: Download the Excel template.</strong>
                    <div class="ms-3">
                        <a [href]="templateUrl()" download>
                            <i class="bi bi-download"></i> Download Excel Template
                        </a>
                    </div>
                </li>
                <li class="mb-2">
                    <strong>Step 2: Create your Excel file following the required format.</strong>
                    <div class="ms-3">
                        <p class="mb-1">Your Excel file must contain the following columns (in any order):</p>
                        <ul class="mb-2">
                            @for (col of requiredColumns(); track col) {
                              <li><code>{{ col }}</code></li>
                            }
                        </ul>
                        <strong>Example:</strong>
                        <table class="table table-bordered table-sm mb-0">
                            <thead>
                                <tr>
                                    @for (col of requiredColumns(); track col) {
                                      <th>{{ col }}</th>
                                    }
                                </tr>
                            </thead>
                        </table>
                    </div>
                </li>
                <li>
                    <strong>Step 3: Upload your completed Excel file below.</strong>
                </li>
            </ol>
        </div>
        @if (backendErrors().length) {
          <div class="alert alert-danger mt-3">
            <ul>
              @for (err of backendErrors(); track err) {
                <li>{{ err }}</li>
              }
            </ul>
          </div>
        }
        <form #studentForm="ngForm" AutoFormError (ngSubmit)="onSubmit(studentForm)">
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="StudentFile">
                        <i class="bi bi-file-earmark-excel me-2"></i>Upload Student Excel File <span class="text-danger">*</span>
                    </label>
                    <input
                        type="file"
                        id="StudentFile"
                        class="form-control"
                        (change)="selectedFile.set($any($event.target).files[0]);onFileChange($event)"
                        accept=".xlsx, .xls"
                        required
                        name="studentFile"
                    />
                    <!-- Show selected file info -->
                    @if (selectedFile()) {
                      <div class="mt-2">
                          <small class="text-success">
                              <i class="bi bi-check-circle"></i> File selected: {{ selectedFile()?.name }}
                          </small>
                      </div>
                    }
                </div>
            </div>

            <!-- Table Preview -->
            @if (uploadedData) {
              <div class="mt-3">
                  <h5><i class="bi bi-table me-2"></i>Import Preview</h5>
                  <table class="table table-bordered">
                      <thead>
                          <tr>
                              @for (col of requiredColumns(); track col) {
                                  <th>{{ col }}</th>
                                }
                          </tr>
                      </thead>
                      <tbody>
                          @for (row of uploadedData(); track row) {
                              <tr>
                                  @for (col of requiredColumns(); track col) {
                                      <td>{{ row[col] }}</td>
                                  }
                              </tr>
                          }
                      </tbody>
                  </table>
              </div>
            }
        </form>
    </div>
</div>
